Сервис управления паспортами
=========================================

**О проекте:**
==
Данное приложение - сервис для управления паспортами.
Есть возможность выполнять добавлять, редактировать, обновлять и просматривать данные о паспортах.
Сервис отвечает за проверку просроченности паспортов.
Он периодически проверяет наличие просроченных паспортов и при нахождении таковых
отправляет запрос через брокер сообщений к [сервису рассылки почты](https://github.com/ilyapavlovru/job4j_passport_email_service),
который отправляет уже на почту сообщения о том, что паспорт просрочен и нужно его заменить.

**Используемые технологии:**
==
- Java 17
- Spring (ORM, Data)
- PostgreSQL, Hibernate, JDBC
- Maven, Tomcat

**Как запустить приложение через docker-compose:**
==
- Собрать образ приложения:
```
docker build -t password .
```

- Запустить скрипт docker-compose:
```
docker-compose up
```

- Запустить приложение:

Для проверки работы приложения можно воспользоваться Postman, url по умолчанию - http://127.0.0.1:8080

**Как запустить приложение в Kubernetes:**
==

- Предварительная установка:
  для запуска приложения в Kubernetes необходимо предварительно установить: git, docker, kubectl и minikube

- Настройка Kubernetes и развертывание:
    + Перейти в директорию job4j_passport/k8s. Выполняем команду ниже. Она создает secret из указанного файла:
      ```
      kubectl apply -f postgresdb-secret.yml
      ```
    + Вносим ConfigMap в кластер:
      ```
      kubectl apply -f postgresdb-configmap.yml
      ```
    + Запускаем создание развертывания для Postgres:
      ```
      kubectl apply -f postgresdb-deployment.yml
      ```
    + Запускаем создание развертывания для Spring Boot приложения:
      ```
      kubectl apply -f spring-deployment.yml
      ```
    + Далее набираем команду ниже. Команда service возвращает нам URL, по которому мы можем подключиться к сервису из вне:
      ```
      minikube service spring-boot-service
      ```

- Запустить приложение:

Для проверки работы приложения можно воспользоваться Postman, url по умолчанию - http://192.168.49.2:32100.